# match

Flutter base with Clean Architecture, BLoC, Dio, GetIt + Injectable, Freezed. Managed by FVM (stable).

## Tech stack
- **State**: `bloc`, `flutter_bloc`
- **DI**: `get_it`, `injectable`
- **Networking**: `dio`
- **Data classes**: `freezed`, `json_serializable`
- **Tooling**: `build_runner`, `fvm`, `recase`

## Project structure
```text
lib/
  core/
    di/
      injection.dart                # GetIt instance + configureDependencies()
      injection.config.dart         # GENERATED by injectable
    network/
      dio_module.dart               # Dio provider (@module/@lazySingleton)
    usecase/
      usecase.dart                  # UseCase base + NoParams

  features/
    posts/
      domain/
        entities/
          post.dart                 # Freezed entity
        repositories/
          posts_repository.dart     # Abstraction
        usecases/
          get_posts.dart            # UseCase
      data/
        datasources/
          posts_remote_data_source.dart  # Dio calls
        models/
          post_model.dart           # Freezed + JSON model
        repositories/
          posts_repository_impl.dart# Impl with mapping model -> entity
      presentation/
        bloc/
          posts_bloc.dart           # Freezed events/states + logic
        pages/
          posts_page.dart           # UI + BlocBuilder

  main.dart                         # Bootstrap DI, start app, show PostsPage
```

## Runtime flow (request → UI)
- **UI**: `PostsPage` provides `PostsBloc` from `getIt` and dispatches `started()`.
- **Bloc**: `PostsBloc` calls `GetPostsUseCase(NoParams)` and emits `loading/success/failure`.
- **UseCase**: delegates to `PostsRepository` abstraction.
- **Repository**: uses `PostsRemoteDataSource` to fetch from Dio and maps `PostModel → Post`.
- **RemoteDataSource**: `Dio.get('/posts')` with baseUrl from `core/network/dio_module.dart`.
- **Back to Bloc**: emits `success(List<Post>)` → UI renders list.

## Dependency Injection
- Configure at app start: `configureDependencies()` in `core/di/injection.dart`.
- Injectable generates registrations into `injection.config.dart`.
- Provided bindings include: `Dio`, `PostsRemoteDataSource`, `PostsRepository`, `GetPostsUseCase`, `PostsBloc`.

## Commands
- **Run app**:
```bash
fvm flutter run
```
- **Codegen (freezed/injectable/json)**:
```bash
fvm flutter pub run build_runner build --delete-conflicting-outputs
```
- **Analyze**:
```bash
fvm flutter analyze
```

## Routing
- Sử dụng `go_router` với cấu hình trung tâm ở `core/router/app_router.dart`.
- Định tuyến hiện tại:
  - `/posts` → `PostsPage`
  - `/comments` → `CommentsPage`
- Tích hợp trong `main.dart` bằng `MaterialApp.router` với `routerConfig: appRouter`.
- Điều hướng ví dụ:
```dart
import 'package:go_router/go_router.dart';

// context.go('/comments');
// context.push('/posts');
```

## Module generator
Tạo nhanh module Clean Architecture (domain/data/presentation + Bloc + Freezed + Injectable).

Usage:
```bash
fvm flutter pub run tool/generate_module.dart <module_name>
# ví dụ
fvm flutter pub run tool/generate_module.dart comments
```
Sau khi sinh file, chạy codegen:
```bash
fvm flutter pub run build_runner build --delete-conflicting-outputs
```
Đi tới trang: `lib/features/<module>/presentation/pages/<module>_page.dart` hoặc thêm route để điều hướng.

Lưu ý: Generator sẽ tự động thêm import và `GoRoute` vào `core/router/app_router.dart` (ví dụ: `/<module>` → `<Module>Page`).

### Quy ước đặt tên khi generate
- **Module**: số nhiều (ví dụ `comments`, `posts`).
- **Entity/Model**: số ít tự động (ví dụ `Comment`, `Post`).

## Tùy biến nhanh
- **Đổi API baseUrl**: `core/network/dio_module.dart` (`BaseOptions.baseUrl`).
- **Thêm feature thủ công**: sao chép cấu trúc trong `features/posts` hoặc dùng generator ở trên.
- **Gắn trang khởi đầu**: cập nhật `home:` trong `main.dart` trỏ tới `<Feature>Page` bạn cần.

